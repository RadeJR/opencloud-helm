# OpenCloud Helm Chart Values
# This is a YAML-formatted file with configuration values for the OpenCloud Helm chart.
# The file is organized into logical sections for different components of the system.

# =====================================================================
# SECURITY WARNING
# =====================================================================
# IMPORTANT: The following default credentials MUST be changed in production environments.
# Using these default values in production is a significant security risk.
#
# Credentials that need to be changed:
# 1. Keycloak Admin: adminUser: admin, adminPassword: admin
# 2. OpenCloud Admin: adminPassword: admin
# 3. PostgreSQL: user: keycloak, password: keycloak
# 4. MinIO: rootUser: opencloud, rootPassword: opencloud-secret-key
# 5. RabbitMQ: url: amqp://guest:guest@localhost


# =====================================================================
# GLOBAL SETTINGS
# =====================================================================

# Global settings that apply across components
global:
  # Domain settings for various services
  domain:
    # Main domain for OpenCloud
    opencloud: cloud.opencloud.test
    # Domain for Keycloak
    keycloak: keycloak.opencloud.test
    # Domain for MinIO
    minio: minio.opencloud.test
    # Domain for WOPI server
    wopi: wopiserver.opencloud.test
    # Domain for Collabora CODE
    collabora: collabora.opencloud.test
    # Domain for OnlyOffice
    onlyoffice: onlyoffice.opencloud.test
    # Domain for Companion
    companion: companion.opencloud.test

  # TLS settings for secure connections
  tls:
    # Enable TLS (set to false when using gateway TLS termination externally)
    enabled: false
    # secretName for TLS certificate
    secretName: ""

  # OpenID Connect (OIDC) Provider Configuration
  # Configure external OIDC provider OR use the built-in Keycloak (keycloak.internal.enabled: true)
  # If an external OIDC provider is configured, it takes precedence over internal Keycloak
  oidc:
    # Enable external OIDC provider (disables automatic configuration from internal Keycloak)
    # Set to true when using Auth0, Okta, Azure AD, Google, or any other external OIDC provider
    enabled: false
    
    # OpenID Connect issuer URL (required when oidc.enabled: true)
    # This is the base URL of your OIDC provider
    # Examples:
    #   - Auth0: https://yourdomain.auth0.com
    #   - Okta: https://yourorg.okta.com/oauth2/default
    #   - Azure AD: https://login.microsoftonline.com/{tenant-id}/v2.0
    #   - Google: https://accounts.google.com
    #   - Keycloak: https://keycloak.example.com/realms/myrealm
    issuer: ""
    
    # OIDC client ID for OpenCloud (required when oidc.enabled: true)
    # This is the client/application ID registered with your OIDC provider
    clientId: "web"
    
    # OIDC account management URL (optional)
    # URL where users can manage their profile, password, MFA, etc.
    # If not set, the account management link will not be displayed
    # Examples:
    #   - Keycloak: https://keycloak.example.com/realms/myrealm/account
    #   - Auth0: https://yourdomain.auth0.com/account
    accountUrl: ""
    
    # OIDC scopes to request (optional, has sensible defaults)
    # Space-separated list of OAuth 2.0 scopes
    # Default: "openid profile email groups roles"
    scopes: ""
    
    # OIDC claim to use for user identification (optional)
    # The claim from the ID token that uniquely identifies the user
    # Common values: "preferred_username", "email", "sub"
    # Default: "preferred_username"
    userClaim: ""
    
    # OIDC claim containing user roles (optional)
    # The claim from the ID token that contains user role assignments
    # Common values: "roles", "groups", "realm_access.roles"
    # Default: "roles"
    roleClaim: ""

  # Global storage settings
  storage:
    # Storage class for persistent volumes
    storageClass: ""

  # Global image settings
  image:
    # Global registry override - if set, it will override all image registries
    # Example: my-private-registry.com
    registry: ""
    # Global pull policy override - if set, it will override all image pull policies
    # Options: Always, IfNotPresent, Never
    pullPolicy: ""

# =====================================================================
# UTILITY IMAGES
# =====================================================================

# Busybox image settings (used for init containers)
busybox:
  image:
    # Busybox image registry
    registry: docker.io
    # Busybox image repository
    repository: library/busybox
    # Busybox image tag
    tag: "1.36"
    # Image pull policy
    pullPolicy: IfNotPresent

# =====================================================================
# IDENTITY PROVIDER (KEYCLOAK)
# =====================================================================

# Keycloak settings for identity and access management
# Structure follows issue #64 - standardized internal/external pattern
keycloak:
  # Internal Keycloak deployment
  internal:
    # Enable internal Keycloak instance
    enabled: true
    # Keycloak image settings
    image:
      # Keycloak image registry
      registry: quay.io
      # Keycloak image repository
      repository: keycloak/keycloak
      # Keycloak image tag
      tag: "26.1.4"
      # Image pull policy
      pullPolicy: IfNotPresent
    # Number of Keycloak replicas
    replicas: 1

    # Use existing secret for keycloak credentials (Note: secretKeyName must be adminUser and adminPassword)
    existingSecret: ""

    # Admin user
    # ignored if keycloak.internal.existingSecret is set
    adminUser: admin

    # Admin password
    # ignored if keycloak.internal.existingSecret is set
    adminPassword: admin

    # Keycloak realm
    realm: "openCloud"

    # CORS settings for cross-origin requests
    cors:
      # Enable CORS
      enabled: true
      # Allow all origins
      allowAllOrigins: true
      # Allowed origins (used if allowAllOrigins is false)
      origins: []
      # Allowed methods
      methods: "GET,POST,PUT,DELETE,OPTIONS"
      # Allowed headers
      headers: "Origin,Accept,Authorization,Content-Type,Cache-Control"
      # Exposed headers
      exposedHeaders: "Access-Control-Allow-Origin,Access-Control-Allow-Credentials"
      # Allow credentials
      allowCredentials: "true"
      # Max age in seconds
      maxAge: "3600"
    # Resources
    resources: {}

# PostgreSQL settings for Keycloak
postgres:
  # Enable PostgreSQL
  enabled: true
  # PostgreSQL image settings
  image:
    # PostgreSQL image registry
    registry: docker.io
    # PostgreSQL image repository
    repository: postgres
    # PostgreSQL image tag
    tag: "alpine"
    # Image pull policy
    pullPolicy: IfNotPresent

  # Database name
  database: keycloak

  # Use existing secret for postgres credentials (Note: secretKeyName must be username and password)
  existingSecret: ""

  # Database user
  # ignored if postgres.existingSecret is set
  user: keycloak

  # Database password
  # ignored if postgres.existingSecret is set
  password: keycloak

  # Resources allocation
  resources:
    requests:
      cpu: 100m
      memory: 128Mi
    limits:
      cpu: 500m
      memory: 512Mi
  # Persistence configuration
  persistence:
    enabled: true
    # Name of existing PVC to use (overrides all other persistence values)
    existingClaim: ""
    # Size of the persistent volume
    size: 1Gi
    # Storage class
    storageClass: ""
    # Access mode
    accessMode: ReadWriteOnce


# =====================================================================
# EXTENSIONS
# =====================================================================

# Tika settings for full-text search
tika:
  # Enable Tika
  enabled: true
  # Tika image settings
  image:
    # Tika image registry
    registry: docker.io
    # Tika image repository
    repository: apache/tika
    # Tika image tag
    tag: "2.9.2.1-full"
    # Image pull policy
    pullPolicy: IfNotPresent
  # Resources allocation
  resources:
    requests:
      cpu: 100m
      memory: 1Gi
    limits:
      cpu: 1000m
      memory: 3Gi

# Web Extensions settings
webExtensions:
  # Enable web extensions
  enabled: true
  # Common image settings for all extensions
  image:
    # Registry for web extensions
    registry: docker.io
    # Repository for web extensions
    repository: opencloudeu/web-extensions
    # Image pull policy
    pullPolicy: IfNotPresent
  # List of extensions to install
  extensions:
    # Draw.io extension
    drawio:
      enabled: true
      tag: draw-io-1.0.0
    # External Sites extension
    externalsites:
      enabled: true
      tag: external-sites-1.0.0
    # Importer extension
    importer:
      enabled: true
      tag: importer-1.0.0
    # JSON Viewer extension
    jsonviewer:
      enabled: true
      tag: json-viewer-1.0.0
    # Progress Bars extension
    progressbars:
      enabled: true
      tag: progress-bars-1.0.0
    # Unzip extension
    unzip:
      enabled: true
      tag: unzip-1.0.0

# =====================================================================
# COLLABORATION (COLLABORA)
# =====================================================================

collabora:
  enabled: false
  image:
    registry: docker.io
    repository: collabora/code
    pullPolicy: IfNotPresent
    tag: 24.04.13.2.1
  ssl:
    enabled: true
    verification: true

  # Use existing secret for collabora credentials (Note: secretKeyName must be username and password)
  existingSecret: ""

  admin:
    # ignored if collabora.existingSecret is set
    username: admin

    # ignored if collabora.existingSecret is set
    password: admin

  resources:
    requests:
      cpu: 100m
      memory: 256Mi
    limits:
      cpu: 1
      memory: 1Gi

# =====================================================================
# COLLABORATION (ONLYOFFICE)
# =====================================================================

# OnlyOffice settings for document collaboration
onlyoffice:
  # Enable OnlyOffice
  enabled: true
  # OnlyOffice image settings
  image:
    # OnlyOffice image registry
    registry: docker.io
    # OnlyOffice image repository
    repository: onlyoffice/documentserver
    # OnlyOffice image tag
    tag: 8.2.2
    # Image pull policy
    pullPolicy: IfNotPresent
  # WOPI settings
  wopi:
    # Enable WOPI
    enabled: true
  # Use unauthorized storage (for self-signed certificates)
  useUnauthorizedStorage: true
  # Database configuration
  db:
    # Use existing secret for database password
    existingSecret: ""
    # Key in the existing secret that contains the password
    secretKeyName: "password"
  # Persistence configuration
  persistence:
    # Enable persistence
    enabled: true
    # Name of existing PVC to use (overrides all other persistence values)
    existingClaim: ""
    # Size of the persistent volume
    size: 2Gi
  # Resources allocation
  resources:
    requests:
      cpu: 100m
      memory: 256Mi
    limits:
      cpu: 5000m
      memory: 10Gi
  # Configuration for local.json
  config:
    # CoAuthoring service settings
    coAuthoring:
      # SQL database settings
      sql:
        type: "postgres"
        dbHost: "localhost"
        dbPort: "5432"
        dbName: "onlyoffice"
        dbUser: "onlyoffice"
      
      # Secret settings
      secret:
        # Use existing secret for onlyoffice credentials (Note: secretKeyName must be sessionSecret)
        existingSecret: ""
        
        # ignored if onlyoffice.config.coAuthoring.secret.existingSecret is set
        session:
          string: "Dd0SXIe1k9oCfdffgrfNmA0TK1bb1B1d38OFSb"
    # RabbitMQ settings
    rabbitmq:
      # Use existing secret for onlyoffice rabbitmq credentials (Note: secretKeyName must be url)
      existingSecret: ""

      # ignored if onlyoffice.config.rabbitmq.existingSecret is set
      url: "amqp://guest:Dd0SXIe1k9osdfjkmA0TK1bb1B1d38OFSb@localhost"
    # File converter settings
    fileConverter:
      converter:
        inputLimits:
          - type: "docx;dotx;docm;dotm"
            zip:
              uncompressed: "1GB"
              template: "*.xml"
          - type: "xlsx;xltx;xlsm;xltm"
            zip:
              uncompressed: "1GB"
              template: "*.xml"
          - type: "pptx;ppsx;potx;pptm;ppsm;potm"
            zip:
              uncompressed: "1GB"
              template: "*.xml"
  # Collaboration service settings
  collaboration:
    # Enable collaboration service
    enabled: true
    # Resources allocation
    resources:
      requests:
        cpu: 100m
        memory: 256Mi
      limits:
        cpu: 5000m
        memory: 10Gi

# =====================================================================
# OPENCLOUD CORE
# =====================================================================

# Service Account configuration
serviceAccount:
  # Specifies whether a service account should be created
  create: true
  # Annotations to add to the service account
  annotations: {}
  # The name of the service account to use.
  # If not set and create is true, a name is generated using the fullname template
  name: ""

# Image settings for OpenCloud
image:
  # OpenCloud image registry
  registry: docker.io
  # OpenCloud image repository
  repository: opencloudeu/opencloud-rolling
  # OpenCloud image tag
  tag: "2.1.0"
  # Image pull policy
  pullPolicy: IfNotPresent
  # Image pull secrets for private registries
  # Reference existing secrets by name
  pullSecrets: []
  # Example:
  # - name: my-registry-secret

# OpenCloud core settings
opencloud:
  # Enable OpenCloud
  enabled: true
  # Number of replicas (Note: When using multiple replicas, persistence should be disabled
  # or use a storage class that supports ReadWriteMany access mode)
  replicas: 1
  
  # Use existing secret for opencloud admin credentials (Note: secretKeyName must be adminPassword)
  existingSecret: ""
  
  # Admin password
  # ignored if opencloud.existingSecret is set
  adminPassword: admin
  
  # Create demo users
  createDemoUsers: false
  # Additional services to start
  additionalServices: []
  # Services to exclude from starting (will be added to automatically based on configuration)
  # Note: 'idp' is automatically excluded when using external OIDC or Keycloak
  # Note: 'nats' is automatically excluded when using external NATS
  excludeServices: []
  
  # Application configuration
  # Unified configuration for OpenCloud services
  # Settings are organized by configuration method:
  #   - env: Settings configured via environment variables
  #   - files: Settings configured via ConfigMap files (complex YAML/JSON structures)
  config:
    # Environment-based configuration
    # These settings are passed to OpenCloud services as environment variables
    env:
      # Logging configuration
      log:
        # Log level (debug, info, warn, error)
        level: info
        # Enable colored log output
        color: false
        # Enable pretty-printed JSON logs
        pretty: false
      
      # Insecure mode (for self-signed certificates)
      insecure: true
      
      # Graph service configuration (roles and user management)
      graph:
        # Available roles (comma-separated list or array)
        # Default OpenCloud roles: Admin, SpaceAdmin, User, Guest, etc.
        availableRoles:
          - "b1e2218d-eef8-4d4c-b82d-0f1a1b48f3b5"  # Admin
          - "a8d5fe5e-96e3-418d-825b-534dbdf22b99"  # SpaceAdmin
          - "fb6c3e19-e378-47e5-b277-9732f9de6e21"  # User
          - "58c63c02-1d89-4572-916a-870abc5a1b7d"  # User Light
          - "2d00ce52-1fc2-4dbc-8b95-a73b73395f5a"  # Guest
          - "1c996275-f1c9-4e71-abdf-a42f6495e960"  # User Profile
          - "312c0871-5ef7-4b3a-85b6-0e4074c64049"  # Graph User
          - "aa97fe03-7980-45ac-9e50-b325749fd7e6"  # Graph Viewer
        # Assign default user role automatically
        assignDefaultUserRole: false
        # Username matching strategy (none, email, username)
        usernameMatch: "none"
      
      # Proxy service configuration
      proxy:
        # Use TLS between proxy and OpenCloud services
        tls: false
        # Enable basic authentication
        enableBasicAuth: false
        # Auto-provision user accounts from OIDC
        autoprovisionAccounts: true
        # Role assignment driver (oidc, default)
        roleAssignmentDriver: "oidc"
        # OIDC configuration (used when Keycloak or external OIDC is enabled)
        oidc:
          # Rewrite OIDC well-known endpoint
          rewriteWellknown: true
          # OIDC claim to use for user identification
          userOidcClaim: "preferred_username"
          # CS3 claim to use for user identification
          userCs3Claim: "username"
          # OIDC claim containing user roles
          roleAssignmentClaim: "roles"
          # Access token verification method (jwt, none)
          accessTokenVerifyMethod: "jwt"
      
      # Frontend configuration
      frontend:
        # Read-only user attributes (comma-separated)
        # These attributes are managed by the IDP and cannot be changed in OpenCloud
        readonlyUserAttributes: "user.onPremisesSamAccountName,user.displayName,user.mail,user.passwordProfile,user.accountEnabled,user.appRoleAssignments"
      
      # Web UI configuration
      web:
        # OIDC scope to request
        oidcScope: "openid profile email groups roles"
      
      # Sharing configuration
      sharing:
        # Require password for public shares
        publicShareMustHavePassword: false
      
      # Password policy configuration
      passwordPolicy:
        # Filename of banned passwords list (relative to /etc/opencloud)
        bannedPasswordsFile: "banned-password-list.txt"
      
      # Gateway configuration
      gateway:
        # Gateway gRPC address (makes REVA gateway accessible to app drivers)
        grpcAddr: "0.0.0.0:9142"
      
      # Search configuration
      search:
        # Extractor type (tika, basic)
        # Note: If set to "tika" but tika.enabled is false, will automatically fall back to "basic"
        # This prevents service startup failures when Tika is not available
        extractorType: "tika"
      
      # gRPC performance settings
      grpc:
        # Maximum received message size in bytes
        maxReceivedMessageSize: "102400000"
      
      # Admin user configuration
      admin:
        # Admin user ID (leave empty for default)
        userId: ""
    
    # File-based configurations
    # These are complex configurations that are better suited as YAML/JSON files
    # rather than environment variables. They are mounted as ConfigMaps.
    files:
      # Web UI theme
      theme: "owncloud"
      
      # App registry configuration
      # Leave empty to use default from files/opencloud/app-registry.yaml
      appRegistry: {}
      
      # CSP (Content Security Policy) configuration
      # Leave empty to use default from files/opencloud/csp.yaml.gotmpl
      # The default template includes dynamic values for domains
      csp: {}
      
      # Proxy configuration (advanced)
      # Leave empty for default configuration
      # Format: YAML object that will be rendered as-is into proxy.yaml
      # Example:
      proxy: {}
        # role_assignment:
        #   oidc_role_mapper:
        #     role_mapping:
        #       - role_name: admin
        #         claim_value: opencloud-admin
        #       - role_name: spaceadmin
        #         claim_value: opencloud-spaceadmin
        #       - role_name: user
        #         claim_value: opencloud-user
        #       - role_name: guest
        #         claim_value: opencloud-guest

      # Banned password list configuration
      # Format: Multi-line string (not YAML array)
      # Use the |- syntax to preserve line breaks
      # Add one password per line - do not use YAML list syntax (no dashes)
      # Example:
      #   bannedPasswordList: |-
      #     password1
      #     password2
      #     password3
      # For very long lists override the file 'files/opencloud/banned-password-list.txt'
      bannedPasswordList: |-
  
  # Raw environment variable overrides (advanced use)
  # These will be added to the container env section after all generated env vars
  # Use this for any OpenCloud env vars not covered by config.env above
  extraEnv: []
  # Example:
  # - name: CUSTOM_ENV_VAR
  #   value: "custom-value"
  
  # Environment variables from ConfigMaps or Secrets
  extraEnvFrom: []
  # Example:
  # - configMapRef:
  #     name: my-configmap
  # - secretRef:
  #     name: my-secret
  # Resources allocation
  resources:
    requests:
      cpu: 128m
      memory: 128Mi
    limits:
      memory: 20Gi
  
  # Pod scheduling configuration
  # Node selector for pod assignment
  nodeSelector: {}
  # Example:
  # disktype: ssd
  
  # Tolerations for pod assignment
  tolerations: []
  # Example:
  # - key: "key1"
  #   operator: "Equal"
  #   value: "value1"
  #   effect: "NoSchedule"
  
  # Affinity rules for pod assignment
  affinity: {}
  # Example:
  # podAntiAffinity:
  #   preferredDuringSchedulingIgnoredDuringExecution:
  #   - weight: 100
  #     podAffinityTerm:
  #       labelSelector:
  #         matchExpressions:
  #         - key: app.kubernetes.io/name
  #           operator: In
  #           values:
  #           - opencloud
  #       topologyKey: kubernetes.io/hostname
  
  # Additional pod annotations
  podAnnotations: {}
  
  # Additional pod labels
  podLabels: {}
  
  # Termination grace period in seconds
  terminationGracePeriodSeconds: 30
  
  # DNS policy for the pod
  dnsPolicy: ClusterFirst
  
  # Init container resource configuration
  initResources:
    requests:
      cpu: 10m
      memory: 32Mi
    limits:
      cpu: 100m
      memory: 128Mi
  
  # Persistence configuration
  persistence:
    config:
      # Enable persistence
      enabled: true
      # Name of existing PVC to use (overrides all other persistence values)
      existingClaim: ""
      # Size of the persistent volume for config
      size: 5Gi
      # Storage class
      storageClass: ""
      # Access mode (ReadWriteOnce or ReadWriteMany for multiple replicas)
      accessMode: ReadWriteOnce
    data:
      # Enable persistence
      enabled: true
      # Name of existing PVC to use (overrides all other persistence values)
      existingClaim: ""
      # Size of the persistent volume for data
      size: 30Gi
      # Storage class
      storageClass: ""
      # Access mode (ReadWriteOnce or ReadWriteMany for multiple replicas)
      accessMode: ReadWriteOnce

  nats:
    external:
      # -- Use an external NATS messaging system instead of the internal one.
      # Recommended for all production instances.
      # Needs to be used if HighAvailability is needed.
      # Needs to be used if OpenCloud shall be used by more than a 2-digit user count.
      enabled: false

      # -- Endpoint of the messaging system.
      endpoint: nats.opencloud-nats.svc.cluster.local:4222

      # -- Cluster name to use with the messaging system.
      cluster: opencloud-cluster

      tls:
        # -- Enables TLS encrypted communication with the messaging system.
        # Recommended for production installations.
        enabled: false
        
        # -- Set only to false, if the certificate of your messaging system service is not trusted.
        # If set to false, you need to put the CA cert of the messaging system server into the secret referenced by "caSecretName"
        certTrusted: true

        # -- Disables SSL certificate checking for connections to the messaging system server.
        # -- For self signed certificates, consider to put the CA cert of the messaging system secure server into the secret referenced by "caSecretName"
        # Not recommended for production installations.
        insecure: false

        # Use existing CA secret for nats credentials (Note: secretKeyName must be 'ca.crt' with the root CA certificate for NATS)
        # Only used if certTrusted is false
        caSecretName : opencloud-nats-ca

  # =====================================================================
  # EMAIL (SMTP)
  # =====================================================================
  
  # SMTP settings for email notifications
  smtp:
    # Enable SMTP
    enabled: false
    # SMTP host
    host: ""
    # SMTP port
    port: "587"
    # SMTP sender
    sender: ""
    
    # Use existing secret for opencloud smtp credentials (Note: secretKeyName must be smtpUser and smtpPassword)
    existingSecret: ""
    
    # SMTP username
    # ignored if opencloud.smtp.existingSecret is set
    username: ""

    # SMTP password
    # ignored if opencloud.smtp.existingSecret is set
    password: ""

    # SMTP insecure (allow self-signed certificates)
    insecure: "false"
    # SMTP authentication method
    authentication: "plain"
    # SMTP encryption method
    encryption: "starttls"

  # =====================================================================
  # STORAGE CONFIGURATION
  # =====================================================================
  
  # Storage configuration
  storage:
    # Storage mode for user files, can be "s3" (default) or "posixfs"
    mode: s3
    # S3 storage configuration
    s3:
      # Internal MinIO instance
      internal:
        # Enable internal test MinIO instance (default: true)
        enabled: true
        # MinIO image settings
        image:
          # MinIO image registry
          registry: docker.io
          # MinIO image repository
          repository: minio/minio
          # MinIO image tag
          tag: latest
          # Image pull policy
          pullPolicy: IfNotPresent
        # httpRoute configuration
        httpRoute:
          # Enable HTTPRoute for MinIO (default: false)
          enabled: false
        
        # Use existing secret for minio credentials (Note: secretKeyName must be rootUser and rootPassword)
        existingSecret: ""
        
        # Minio Root user
        # ignored if opencloud.storage.s3.internal.existingSecret is set
        rootUser: opencloud

        # Minio Root password
        # ignored if opencloud.storage.s3.internal.existingSecret is set
        rootPassword: opencloud-secret-key
        
        # Bucket name
        bucketName: opencloud-bucket
        # Region (optional)
        region: "default"
        # Resources allocation
        resources:
          requests:
            cpu: 100m
            memory: 256Mi
          limits:
            cpu: 1000m
            memory: 2Gi
        # Persistence configuration
        persistence:
          enabled: true
          # Name of existing PVC to use (overrides all other persistence values)
          existingClaim: ""
          # Size of the persistent volume
          size: 30Gi
          # Storage class
          storageClass: ""
          # Access mode
          accessMode: ReadWriteOnce
      # External S3 (can be S3, Ceph, or external MinIO)
      external:
        # Enable external S3
        enabled: false
        # External S3 endpoint URL
        endpoint: ""
        # External S3 region
        region: "default"
        
        # Use existing secret for external s3 credentials (Note: secretKeyName must be accessKey and secretKey)
        existingSecret: ""
        
        # External S3 access key
        # ignored if opencloud.storage.s3.external.existingSecret is set
        accessKey: ""

        # External S3 secret key
        # ignored if opencloud.storage.s3.external.existingSecret is set
        secretKey: ""

        # External S3 bucket
        bucket: ""
        # Create bucket if it doesn't exist
        createBucket: true
    posixfs:
      # The type of the cache store, supported values are: 'memory', 'redis-sentinel', 'nats-js-kv' (default), 'noop'
      idCacheStore: nats-js-kv
      # Path of storage root directory, default is /var/lib/opencloud/storage
      # IMPORTANT: Path must be outside /var/lib/opencloud to avoid permission conflicts
      # See: https://docs.opencloud.eu/docs/admin/configuration/storage/storage-posix/
      rootPath: "/mnt/posixfs"
      persistence:
        # Enable persistence
        enabled: true
        # Name of existing PVC to use (overrides all other persistence values)
        existingClaim: ""
        # Size of the persistent volume for data
        size: 30Gi
        # Storage class
        storageClass: ""
        # Access mode (ReadWriteOnce or ReadWriteMany for multiple replicas)
        accessMode: ReadWriteMany

# =====================================================================
# GATEWAY-API HTTPRoute
# =====================================================================

# Requires Gateway API resources and suitable controller installed within the cluster
# (see: https://gateway-api.sigs.k8s.io/guides/)
httpRoute:
  # Enable HTTPRoute resources (set to true to create Gateway API routes)
  enabled: false

  # Gateway configuration
  gateway:
    # Create the gateway
    create: false
    # HTTPS Port to listen to (k3s traefik defaults to 8443)
    port: 443
    # Gateway name
    name: opencloud-gateway
    # Gateway class (defaults to "cilium")
    className: cilium
    # Gateway namespace (defaults to Release.Namespace)
    namespace: ""
    # Gateway section name (applies to all routes). If set to a non-empty value, this overrides the default component-specific section names (e.g., opencloud-https, onlyoffice-https) for all routes. If left empty, the defaults are used.
    sectionName: ""
    # Gateway annotations
    annotations:
    # Gateway annotations
    infrastructure:
      annotations: {}

# =====================================================================
# INGRESS
# =====================================================================

# Ingress configuration
ingress:
  # Whether to enable ingress resources for components
  enabled: false

  # The ingress class name to use (e.g., nginx, traefik). Leave empty to use the cluster default.
  # Note: This sets the Kubernetes `spec.ingressClassName` field.
  ingressClassName: ""

  # Some components (e.g., OnlyOffice) require the X-Forwarded-Proto header to be set.
  #
  # Set 'annotationsPreset' to inject known ingress-controller-specific annotations
  # for injecting the header. Supported values: nginx, nginx-no-snippets, traefik, haproxy, contour, istio
  #
  # Use 'nginx-no-snippets' for environments where NGINX configuration snippets are forbidden
  # (e.g., Rackspace, security-restricted clusters). This preset uses built-in NGINX features
  # instead of custom configuration snippets.
  #
  # If set to "traefik" and OnlyOffice is enabled, the chart will create a Middleware
  # named 'add-x-forwarded-proto-https' for use in both Ingress and Gateway HTTPRoute.
  #
  # This is required because Traefik does not allow simple header injection via annotations
  # or Gateway filters and instead expects a Middleware to be referenced.
  #
  # These annotations are added in addition to any defined in 'annotations'.
  # If there's a conflict, Helm will error. To avoid this, set annotationsPreset: ""
  # and define all annotations manually (including creating any required Middleware).
  annotationsPreset: ""  # optional, default ""

  # Custom annotations applied to all ingress resources.
  # These are merged with any annotations from 'annotationsPreset' (if set).
  annotations: {}
    # Example:
    # cert-manager.io/cluster-issuer: letsencrypt
